# yemot-router2

ספריה שמאפשרת לתכנת מערכות טלפוניות בקלות באמצעות [מודול API](https://f2.freeivr.co.il/post/76) של 'ימות המשיח'.

# התקנה

```bash
npm install yemot-router2
```

# שימוש בסיסי

הספריה עובדת על ידי חיקוי של Express Router.<br>

הראוטר מקבל פונקצייה אסינכרונית (CallBack), שהארגומנט שהיא מקבלת מהראוטר הוא אובייקט `Call` (יבואר בהמשך),<br>

באמצעות המתודות של האובייקט הזה, ניתן לקבל מידע אודות השיחה, להשמיע/לבקש נתונים מהמחייג, להפנות אותו לשלוחה אחרת, ועוד.

**👈👈 ראה דוגמה בסיסית ב [example.js](example.js)**

# **יומן שינויים**

## ‏6.0.0

⚠️ גרסה 6 כוללת **שינויים שוברים משמעותיים** בAPI של הספריה ⚠️

לפני שדרוג פרויקט קיים לגרסה זו יש לוודא שעדכנתם את הקוד הקיים לשינויים השוברים מפורטים להלן:

### **שינויים שוברים:**

- ‫הוסרו המשתנים `call.query` ו-`call.body`, במקומם נוסף המשתנה `call.values` שמכיל את הquery/body בהתאמה, לפי שיטת הפניה מימות - GET או POST.
- הוסר המשתנה `call.params`, ניתן להשתמש ב`call.req.params` במקום.
- הפרמטר הבוליאני של `id_list_message` שהגדיר האם לחבר את ההודעות לפעולה הבאה לצורך שרשור פעולות, **הוסר**, ובמקומו יש להעביר אובייקט, עם `prependToNextAction: true`. פרטים נוספים [בתיעוד](#id_list_messagemessages-options).
- ההגדרות בכתיב השגוי `lenght_max` ו-`lenght_max` שהוצאו משימוש בגרסה 5.0.0, הוסרו סופית ולא יעבדו יותר.
- שמות של אופציות רבות בread שלא היו מספיק ברורות שונו, וב2 מהן אף שונתה ברירת המחדל כדי להתאים לברירת המחדל של ימות המשיח.

**להלן פירוט השינויים בשמות האופציות:**

<div dir="rtl" text-align="right">

| שם ההגדרה הישן           | שם ההגדרה החדש                   | סוג           | הערות                                                |
| ------------------------ | -------------------------------- | ------------- | ---------------------------------------------------- |
| `play_ok_mode`           | `typing_playback_mode`           | *️⃣ הקשות       |                                                      |
| `read_none`              | `allow_none`                     | *️⃣ הקשות       |                                                      |
| `read_none_var`          | `none_val`                       | *️⃣ הקשות       |                                                      |
| `block_change_type_lang` | `block_change_keyboard`          | *️⃣ הקשות       |                                                      |
| `min`                    | `min_digits`                     | *️⃣ הקשות       |                                                      |
| `max`                    | `max_digits`                     | *️⃣ הקשות       |                                                      |
| `block_zero`             | `block_zero_key`                 | *️⃣ הקשות       |                                                      |
| `block_asterisk`         | `block_asterisk_key`             | *️⃣ הקשות       |                                                      |
| `record_ok`              | `no_save_menu`                   | 🎙️ הקלטה       | ברירת מחדל **משמיע** תפריט אישור, הפוך מההגדרה הישנה |
| `record_hangup`          | `save_on_hangup`                 | 🎙️ הקלטה       |                                                      |
| `record_attach`          | `append_to_existing_file`        | 🎙️ הקלטה       |                                                      |
| `allow_typing`           | `block_typing`                   | 🗣️ זיהוי דיבור | ברירת מחדל **מאפשר** הקשות, הפוך מההגדרה הישנה       |
| `use_records_engine`     | `use_records_recognition_engine` | 🗣️ זיהוי דיבור |                                                      |

טיפ - ניתן להשתמש בביטוי הרגולרי הבא כדי לבצע חיפוש בכל הפרויקט בתוכנת VSCode, וכך למצוא בקלות הגדרות בשמות הישנים הדורשים טיפול:

```text
play_ok_mode:| read_none:| read_none_var:| block_change_type_lang:| min:| max:| block_zero:| block_asterisk
```

### **תכונות ושיפורים לא שוברים:**

- נוסף דגל להסרה שקטה של תווים לא חוקיים מהקראת טקסט - `removeInvalidChars`. ראו פירוט [בתיעוד](#תווים-לא-חוקיים-בהקראת-טקסט).
- נוספה תמיכה להגדרות חסרות באפשרות זיהוי דיבור (stt)
- נוספה מתודת `call.hangup()` (קיצור ל `call.go_to_folder('hangup')`)
- התיעוד עודכן ושופר משמעותית

## ‏5.0.0

גרסה 5 כוללת שינויים רבים, כולל שינויים שוברים, ושכתוב משמעותי של הAPI הפנימי.

**שינויים שוברים עיקריים:**

- ‫שם המחלקה `Yemot_router` הוחלף ל `YemotRouter`

- הפרמטרים מהurl לא מוזרקים אוטומטית לאובייקט הcall, אלא זמינים תחת call.req - `call.req.params`/`call.req.query`, בהתאמה, או בקיצור - `call.params`/`call.query`.

- סוג שגיאה חדש: `InputValidationError` - נפלט כאשר הועבר קלט לא חוקי, למשל השמעת הודעת טקסט המכילה תו נקודה.

- ניתן להשתמש במתודות get/post/all כמו באקספרס רגיל. כרגע מתודת `add_fn` נשמרת לצורך תאימות, אבל מומלץ לעדכן.

- ‫`lenght_min` בread מסוג הקלטה תוקן ל`length_min`, כנ"ל `lenght_max` תוקן ל`length_max`. כרגע הכתיב השגוי עדיין נתמך, אבל יוסר בהמשך (הוסר סופית בגרסה 6.0.0).

- שליטה באתחול הראוטר האם יודפסו לוגים פנימיים של הספריה (ברירת מחדל לא - בשונה מבגרסאות הקודמות)

- ‫שמות משתנים הומרו לCamelCase כמקובל, לדוגמה `call_id` הומר ל`callId` וכן הלאה.

בנוסף שיפורים ושינויים רבים לא שוברים, לדוגמה:

- לוג מפורט בהעברת תווים לא חוקיים

- אפשרות העברת מטפל לשגיאות כלליות שלא נתפסו - לא שגיאות פנימיות של הספריה כמו `HangupError`, אלא שגיאה לא צפויה. מאפשר לדוגמה לשלוח מייל למפתח עם לוג מפורט, ולהשמיע למשתמש הודעת שגיאה כללית במקום שהתהליך יקרוס.

- שינויים ושיפורים רבים נוספים מאחורי הקלעים.

### ‏5.0.1

כל הפרמטרים שמתחילים במילה `Api` (פרמטרים אוטומטיים של ימות), לדוגמה `ApiExtension`, `ApiPhone`, כן מוזרקים אוטומטית לאובייקט הCall.

### ‏5.1.1

תוקן באג שבו ניתוק מחוץ לפונקציה (לדוגמה השמעת id_list_message, יציאה מהשלוחה ואז ניתוק) היה מפעיל את הפונקציה.

### ‏5.1.2

תוקנה התמיכה בבקשות POST (ההגדרה `api_url_post=yes` בשלוחה), שבהן הפרמטרים נשלחים ב`body` ולא ב`query`

נוסף פרוקסי שמיירט נסיון גישה לreq.query בבקשות POST או לreq.body בבקשות GET, ומציג הסבר מפורט לתיקון.

## ‏4.0.0

בגרסה 4.0.0 שינוי משמעותי:

במקום לבדוק בכל פעם את הפרמטר `hangup`,

כעת בעת ניתוק, פשוט תיזרק שגיאה.

‫ניתן לתפוס אותה להתנהגות מותאמת אישית, כלומר שאם מבקשים נתון על ידי read והמשתמש מנתק, תתבצע פעולה, לדוגמה למחוק רשומות שכבר נוצרו בשיחה.

אם לא תופסים את השגיאת ניתוק, היא תגרום לעצירה של ריצת הפונקציה (**ללא עצירה של התהליך כולו**, כיוון שהשגיאה יותר גבוה - ע"י הספריה).

# תיעוד

<img width="1200" alt="CleanShot_2023-05-02_at_20 33 00_2x-removebg-preview" src="https://user-images.githubusercontent.com/78599753/235741809-ea6b8a11-06c2-4b95-b2a9-ac193594d6f6.png">

מומלץ להשתמש בכפתור "תוכן העניינים" האוטומטי כדי לנווט בתיעוד:
![CleanShot 2023-05-02 at 04 14 20@2x](https://user-images.githubusercontent.com/78599753/235558893-e8b9ebe0-e2a1-4740-8c96-eb370f9a3952.png)

# מתודות אובייקט ה`Call`

## `read(messages, mode: 'tap' | 'stt' | 'record', options?)`

מתודה לקבלת נתון מהמחייג, מחזירה Promise עם התשובה (במקרה של בקשת הקלטה, יחזור נתיב הקובץ).<br>
פירוט נוסף על read: [https://f2.freeivr.co.il/post/78283](https://f2.freeivr.co.il/post/78283)

### הארגומנט `messages`

ההודעות שיושמעו למחייג לפני קבלת הנתון.<br>
מערך של אובייקטי "הודעה" (ראה [פירוט בהמשך](#אובייקט-message)), שיושמעו למשתמש ברצף.

### הארגומנט `mode`

מגדיר את סוג הנתון שמבקשים מהמחייג:

`tap` = הקשות

`stt` = זיהוי דיבור

`record` = הקלטה

### הארגומנט `options`

בפרמטר הזה, ניתן להעביר אפשרויות נוספות, כגון סך הקשות מינימלי, מקסימלי, וכו'.

#### הקשות

```js
let options = {
    /* שם הערך בימות
    ברירת מחדל, נקבע אוטומטית,
    val_1, val_2, val_3 ...
    */
    val_name: "val_x",
    
    /* האם לבקש את הערך שוב אם קיים. */
    re_enter_if_exists: false,
    
    /* כמות ההקשות המקסימלית */
    max_digits: "*",
    
    /* כמות ההקשות המינימלית */
    min_digits: 1,
    
    /* שניות להמתנה */
    sec_wait: 7,
    
    /* צורת ההשמעה למשתמש את הקשותיו
    באם מעוניינים במקלדת שונה ממקלדת ספרות, כגון EmailKeyboard או HebrewKeyboard, יש להכניס כאן את סוג המקלדת
    [ראו example.js]
    האופציות הקיימות:
    "Number" | "Digits" | "File" | "TTS" | "Alpha" | "No" | "HebrewKeyboard" |
    "EmailKeyboard" | "EnglishKeyboard" | "DigitsKeyboard" | "TeudatZehut" |
    "Price" | "Time" | "Phone" | "No"
    פירוט על כל אופציה ניתן למצוא בתיעוד מודול API של ימות המשיח, תחת"הערך השישי (הקשה)".
    */
    
    typing_playback_mode: "No",
    
    /* האם לחסום הקשה על כוכבית */
    block_asterisk_key: false,
    
    /* האם לחסום הקשה על אפס */
    block_zero_key: false,
    
    /* החלפת תווים*/
    replace_char: "",
    
    /* ספרות מותרות להקשה - מערך
    [1, 2, 3 ...]
    */
    digits_allowed: [],
    
    /* כמה פעמים להשמיע את השאלה לפני שליחת תשובת "None" (כלומר תשובה ריקה). ברירת מחדל פעם אחת */
    amount_attempts: "",
    
    /*
    האם לאפשר תשובה ריקה - או שלאחר זמן ההמתנה יושמע "לא הוקשה בחירה" וידרוש להקיש
    ברירת מחדל לא מאפשר תשובה ריקה
    */
    allow_none: false,
    
    /* הערך שיישלח כשלא הוקשה תשובה. ברירת מחדל "None" */
    none_val: "None",
    
    /* האם לחסום שינוי שפת מקלדת */
    block_change_keyboard: false,
}
```

#### הקלטה

ערכי ברירת מחדל - הקלטות:

```js
const options = {
    /* נתיב לשמירת ההקלטה - שלוחה בלבד, ברירת מחדל שלוחה נוכחית, או api_dir אם מוגדר */
    path: '',

    /* שם קובץ (ללא סיומת) לשמירת ההקלטה, ברירת מחדל - ממוספר אוטומטית כקובץ הגבוה בשלוחה */
    file_name: '',

    /*
    ברירת מחדל משמיע תפריט לאישור ההקלטה/הקלטה מחדש, ניתן להגדיר שמיד בהקשה על סולמית ההקלטה תאושר
    */
    no_save_menu: false,

    /* האם לשמור את ההקלטה באם המשתמש ניתק באמצע הקלטה */
    save_on_hangup: false,

    /*
    במידה והוגדר שם קובץ לשמירה (file_name) וכבר קיים קובץ כזה,
    האם לשנות את שם הקובץ הישן ולשמור את החדש בשם שנבחר (ברירת מחדל), או לצרף את ההקלטה החדשה לסוף הקובץ הישן
    */
    append_to_existing_file: false,

    /* כמות שניות מינימלית להקלטה, ברירת מחדל אין מינימום */
    length_min: '',

    /* כמות שניות מקסימלית להקלטה, ברירת מחדל ללא הגבלה */
    length_max: ''
};
```

#### זיהוי דיבור

ערכי ברירת מחדל - זיהוי דיבור:

```js
const options = {
    /*
    שפת הדיבור
    ברירת מחדל עברית או מה שהוגדר בlang בשלוחה,
    רשימת השפות הזמינות להגדרה: https://did.li/m1lrl
    */
    lang: '',

    /*
    האם לחסום הקשה במצב זיהוי דיבור
    ברירת מחדל מאפשר להקיש תוך כדי הדיבור, כלומר המחייג בוחר אם להקיש או לדבר
    */
    block_typing: false,

    /*
    מקסימום ספרות שאפשר להקיש, באם לא נחסמה ההקשה תוך כדי דיבור
    ברירת מחדל לא מוגבל
    */
    max_digits: '',

    /*
    האם להשתמש במנוע הדיבור של הקלטות - נצרך עבור זיהוי טקסט ארוך
    באם מפעילים הגדרה זו, לא ניתן לקלוט הקשות תוך כדי דיבור
    */
    use_records_recognition_engine: false,

    /*
    אחרי כמה שניות של שקט לסיים את ההקלטה,
    רלוונטי רק אם משתמשים במנוע זיהוי טקסטים ארוכים (use_records_recognition_engine)
    */
    quiet_max: '',

    /*
    מספר שניות מרבי להקלטה,
    רלוונטי רק אם משתמשים במנוע זיהוי טקסטים ארוכים (use_records_recognition_engine)
    */
    length_max: ''
};
```

## `go_to_folder(target)`

מתודה להעברת השיחה לשלוחה מסוימת במערכת הנוכחית.

ניתן לכתוב נתיב יחסי לשלוחה הנוכחית או לשלוחה הראשית, פירוט על האופציות הזמינות ניתן לקרוא [כאן](https://f2.freeivr.co.il/post/58).

ניתן גם להעביר בפרמטר folder את הסטרינג `hangup`, וכך לנתק את השיחה, או להשתמש בקיצור `call.hangup()` (ראו מטה).

## `restart_ext()`

מתודה פשוטה ללא ארגומנטים להפעלה מחדש של השלוחה הנוכחית.

זהה לכתיבה הבאה:

```js
call.go_to_folder(`/${call.ApiExtension}`);
```

## `hangup()`

מנתק את השיחה. קיצור לתחביר הבא:

```js
call.go_to_folder('hangup');
```

## `id_list_message(messages, options?)`

במתודה זו ניתן להשמיע למשתמש הודעה אחת, או מספר הודעות ברצף.<br>
המתודה מקבלת מערך של הודעות ([אובייקט message](#אובייקט-message)) ומשמיעה אותן למשתמש.

⚠️ שים לב! ⚠️

לאחר השמעת ההודעות, השיחה תצא אוטומטית מהשלוחה!

באם מעוניינים לשרשר פעולה נוספת לאחר ההשמעה, לדוגמה להשמיע הודעה ואז לבצע <code>read</code> (קבלת נתונים נוספים), יש להגדיר בארגומנט הoptions את `prependToNextAction` ל`true`.

</div>

## `routing_yemot(number)`

מתודה להעברת השיחה למערכת אחרת בימות המשיח ללא עלות יחידות, באמצעות "ראוטינג ימות".

הפונקציה מקבלת ארגומנט יחיד - סטרינג של מספר מערכת בימות להעברת השיחה.

ניתן גם לנתב את השיחה ממערכת בשרת הפריווט לשרת הרגיל ולהיפך.

## `send(data)`

ניתן להשתמש במתודה זו כדי לשלוח סטרינג חופשי לחלוטין, לדוגמה עבור פונקציונליות שעדיין לא נתמכת בספרייה.

במתודה זו יש להעביר את הסטרינג בדיוק כפי שמעוניינים שהשרת של ימות יקבל אותו, והוא לא עובר ולידציה או עיבוד.

# אובייקט `message`

כל אובייקט הודעה צריך להיות במבנה הבא:

```js
{ type: String, data: String }
```

כאשר `type` הוא סוג הודעה מתוך הטבלה שלהלן, ו`data` הוא המידע עצמו - `String`,<br>
מלבד כאשר ה`type` הוא `zmanim`/`music_on_hold`, שאז ה`data` יהיה אובייקט  - מפורט מתחת לטבלה:
- [zmanim](#מבנה-הdata-בzmanim)
- [music_on_hold](#מבנה-הdata-ב-music_on_hold)

**סוגי הודעות נתמכים:**

<div dir="rtl" text-align="right">

| סוג              | תיאור מקוצר                                                                            | דוגמה                                                                  | הערות                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------- | -------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `text`           | הקראת טקסט                                                                             | `דוגמה לטקסט דוגמה`                                                    | שים לב ל[אזהרה מתחת לטבלה](#תווים-לא-חוקיים-בהקראת-טקסט) לגבי תווים שלא ניתן להקריא                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `file`           | השמעת קובץ אודיו                                                                       | `/1/002`, ניתן לכתוב רק את שם הקובץ `002` אם הקובץ נמצא בתקייה הנוכחית | אין לכתוב סיומת קובץ. [ניתן להשמיע ממאגר גלובלי](https://f2.freeivr.co.il/topic/56/%D7%9E%D7%95%D7%93%D7%95%D7%9C-api-%D7%AA%D7%A7%D7%A9%D7%95%D7%A8-%D7%A2%D7%9D-%D7%9E%D7%97%D7%A9%D7%91%D7%99%D7%9D-%D7%95%D7%9E%D7%9E%D7%A9%D7%A7%D7%99-%D7%A0%D7%AA%D7%95%D7%A0%D7%99%D7%9D-%D7%97%D7%99%D7%A6%D7%95%D7%A0%D7%99%D7%99%D7%9D/4?_=1682984503080#:~:text=%D7%94%D7%A9%D7%9E%D7%A2%D7%AA%20%D7%A7%D7%95%D7%91%D7%A5%20%D7%9E%D7%AA%D7%95%D7%9A%20%D7%9E%D7%90%D7%92%D7%A8%20%D7%92%D7%9C%D7%95%D7%91%D7%9C%D7%99). |
| `speech`         | הקראה אוטומטית של קובץ TTS                                                             | נתיב לקובץ TTS או שם קובץ TTS בתקיה הנוכחית                            | ללא הסיומת                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `digits`         | השמעת ספרות                                                                            | `105` - ישמיע "אחת אפס חמש"                                            | שימושי בעיקר להקראת מספר טלפון                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `number`         | השמעת מספר                                                                             | `105` - ישמיע "מאה וחמש"                                               | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `alpha`          | השמעת אותיות באנגלית                                                                   | `abc`, ישמיע "איי, בי, סי"                                             | לא תומך בעברית                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `zmanim`         | השמעת שעה                                                                              | אובייקט. פירוט בנפרד 👇                                                 | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `system_message` | השמעת הודעת מערכת                                                                      | `M1005` או `1005`                                                      | [רשימת הודעות המערכת](https://f2.freeivr.co.il/post/3)                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `music_on_hold`  | השמעת מוזיקה בהמתנה                                                                    | `{ musicName: 'ztomao', maxSec: 10 }`                                  | הפרמור maxSec רשות. ראה [כאן](https://f2.freeivr.co.il/topic/44/%D7%9E%D7%95%D7%96%D7%99%D7%A7%D7%94-%D7%91%D7%94%D7%9E%D7%AA%D7%A0%D7%94) סוגי מוזיקה זמינים והוראות ליצירת חדש.                                                                                                                                                                                                                                                                                                                                    |
| `date`           | השמעת תאריך עברי                                                                       | פורמט `DD/MM/YYYY` - 28/07/2022                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `dateH`          | השמעת תאריך לועזי                                                                      | פורמט תאריך לועזי `DD/MM/YYYY`, ישמיע את התאריך העברי המתאים           | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `go_to_folder`   | נתיב יחסי לשלוחה הנוכחית או לשלוחה הראשית, ראה [כאן](https://f2.freeivr.co.il/post/58) | העברת השיחה לשלוחה אחרת                                                | לא מומלץ, עדיף להשתמש ב [`call.go_to_folder`](#go_to_folderpath). לא ניתן לשרשר הודעות נוספות לאחר סוג זה.                                                                                                                                                                                                                                                                                                                                                                                                           |
</div>

### תווים לא חוקיים בהקראת טקסט

⚠️ שימו לב! ⚠️

לא ניתן להחזיר לימות את התוים:

נקודה,מקף,גרש,גרשיים,&

העברת אחד מהתוים הנ"ל יגרום לזריקת השגיאה `InputValidationError`.

**כאשר מעבירים טקסט להקראה (`'type: 'text`) ניתן להגדיר הסרה של תווים לא חוקיים**, כלומר שבמקום לזרוק שגיאה הם פשוט יוסרו מהתשובה שתוחזר לימות.

ההגדרה היא `removeInvalidChars`, אותה ניתן להגדיר בשתי רמות, ברמת הודעה בודדת, או ברמת כל ה`read`/`id_list_message`.

דוגמאות:

- ברמת ההודעה המסוימת העברת הפרמטר `removeInvalidChars` באובייקט ההודעה:

```js
{
  type: "text",
  data: "טקסט. בעייתי.",
  removeInvalidChars: true
}
```

- ברמת כל ה`read`/`id_list_message`, העברת הפרמטר `removeInvalidChars` באובייקט האפשרויות.

דוגמה לread:

```js
const resp = await call.read(messagesWidthInvalidChars, 'tap', { removeInvalidChars: true });
```

דוגמה לid_list_message:

```js
await call.id_list_message(messagesWidthInvalidChars, false, { removeInvalidChars: true });
```

### מבנה הdata ב`zmanim`

```js
{
    time: String, // optional, default: "T" (current time)
    zone: String, // optional, default: "IL/Jerusalem",
    difference: String // optional, default: 0
};
```

#### הערך `time`

סוג הזמן שרוצים להשמיע.

ברירת מחדל: "`T`" = השעה הנוכחית.
השמעת שעה - `THH:MM`,
או זמן הלכתי - ניתן לראות [כאן](https://f2.freeivr.co.il/post/82875) את רשימת הזמנים שניתן לחשב מהם זמן.

#### הערך `zone`

אזור הזמן שעבורו יש לחשב את הזמנים.

ברירת מחדל: `IL/Jerusalem`.

ניתן לראות [כאן](https://f2.freeivr.co.il/post/82868) את רשימת אזורי הזמן הקיימים במערכת.

#### הערך `difference`

ערך זה משמש להוספה/הסרה מלאכותית של זמן על הזמן שמשמיעים.

באם לא יועבר פרמטר זה, יושמע הזמן ללא שינוי.

הערך **`difference`** מכיל קודם את סוג הפעולה - פלוס (+) להוספת זמן, או מינוס (-) להפחתת זמן, ואז את הזמן על פי הצורה הבאה: Y - שנה M - חודש D - יום H - שעה m - דקה S - שניה s - אלפית שניה למשל, עבור 20 דקות אחורה יש להגדיר `m20-`, עבור 3 שעות קדימה יש לרשום `H3+`. עבור יומיים אחורה יש לרשום `D1-`.

לדוגמה, עבור השמעת זמן שקיעת החמה מחר בעיר בני ברק:

```js
const messages = [{
    type: 'zmanim',
    data: {
        time: 'sunset',
        zone: 'IL/Bney_Brak',
        difference: '+1D'
    }
}];
```

### מבנה הdata ב-**music_on_hold**

```js
{
    musicName: String,
    maxSec: Number // optional
};
```

[כאן](https://f2.freeivr.co.il/topic/44/%D7%9E%D7%95%D7%96%D7%99%D7%A7%D7%94-%D7%91%D7%94%D7%9E%D7%AA%D7%A0%D7%94) סוגי מוזיקה זמינים והוראות ליצירת חדשה.
